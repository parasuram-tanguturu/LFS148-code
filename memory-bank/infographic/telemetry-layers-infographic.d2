direction: down

title_box: "Telemetry E2E Flow: Bidirectional Data Journey" {
  style: {
    font-size: 44
    bold: true
    font-color: "#1a1a1a"
    fill: "#f5f5f5"
    stroke: "#333"
    stroke-width: 3
  }
}

title_box -> http_world: "" {
  style: {
    stroke-width: 0
  }
}

http_world: HTTP World {
  style: {
    animated: true
    fill: "#2196F3"
    stroke: "#1976D2"
    stroke-width: 4
    font-color: white
    font-size: 22
    bold: true
  }
  label: "üåê HTTP World\n\n‚Ä¢ HTTP Requests/Responses\n‚Ä¢ Headers (traceparent, tracestate)\n‚Ä¢ Status codes, methods\n‚Ä¢ URL paths, query params\n\nExample:\nGET /api/users?page=1\nHost: api.example.com\nTraceparent: 00-..."
}

app_world: Application World {
  style: {
    fill: "#4CAF50"
    stroke: "#388E3C"
    stroke-width: 4
    font-color: white
    font-size: 22
    bold: true
  }
  label: "üíª Application World\n\n‚Ä¢ Business logic execution\n‚Ä¢ Span creation & context propagation\n‚Ä¢ Log generation\n‚Ä¢ Error handling\n‚Ä¢ Instrumentation hooks\n\nExample:\nUserService.getUser(id)\nSpan: GET /api/users\nLog: Processing request"
}

obj_world: Object World {
  style: {
    fill: "#FF9800"
    stroke: "#F57C00"
    stroke-width: 4
    font-color: white
    font-size: 22
    bold: true
  }
  label: "üì¶ Object World\n\n‚Ä¢ Domain objects & DTOs\n‚Ä¢ Span/Log/Metric objects\n‚Ä¢ Attributes & tags\n‚Ä¢ Event structures\n‚Ä¢ Resource metadata\n\nExample:\nSpan{name, traceId, spanId}\nUser{id, name, email}\nMetric{name, value, labels}"
}

rel_world: Relational World {
  style: {
    fill: "#9C27B0"
    stroke: "#7B1FA2"
    stroke-width: 4
    font-color: white
    font-size: 22
    bold: true
  }
  label: "üóÑÔ∏è Relational World\n\n‚Ä¢ Database queries\n‚Ä¢ Data persistence\n‚Ä¢ Relationships & joins\n‚Ä¢ Transaction management\n‚Ä¢ Query optimization\n\nExample:\nSELECT * FROM users\nWHERE id = 123\nINSERT INTO spans..."
}

wire_world: Wire Protocol World {
  style: {
    fill: "#F44336"
    stroke: "#D32F2F"
    stroke-width: 4
    font-color: white
    font-size: 22
    bold: true
  }
  label: "üì° Wire Protocol World\n\n‚Ä¢ OTLP serialization\n‚Ä¢ gRPC/HTTP transport\n‚Ä¢ Protocol buffers\n‚Ä¢ Network transmission\n‚Ä¢ Collector ingestion\n\nExample:\nExportTraceServiceRequest\nOTLP/gRPC ‚Üí Collector\nSerialized spans/logs/metrics"
}

http_world -> app_world: "1Ô∏è‚É£ Request Arrival\n‚Ä¢ Parse HTTP headers\n‚Ä¢ Extract trace context\n‚Ä¢ Create root span\n‚Ä¢ Start request processing" {
  style: {
    animated: true
    stroke-width: 5
    stroke: "#1976D2"
    font-size: 16
    font-color: "#1976D2"
    bold: true
  }
}

app_world -> obj_world: "2Ô∏è‚É£ Object Creation\n‚Ä¢ Transform to domain objects\n‚Ä¢ Create span objects\n‚Ä¢ Build attribute maps\n‚Ä¢ Generate log entries" {
  style: {
    animated: true
    stroke-width: 5
    stroke: "#388E3C"
    font-size: 16
    font-color: "#388E3C"
    bold: true
  }
}

obj_world -> rel_world: "3Ô∏è‚É£ Data Persistence\n‚Ä¢ Execute DB queries\n‚Ä¢ Store business data\n‚Ä¢ Save telemetry data\n‚Ä¢ Commit transactions" {
  style: {
    animated: true
    stroke-width: 5
    stroke: "#F57C00"
    font-size: 16
    font-color: "#E65100"
    bold: true
  }
}

rel_world -> wire_world: "4Ô∏è‚É£ Telemetry Export\n‚Ä¢ Serialize spans/logs/metrics\n‚Ä¢ Encode to OTLP\n‚Ä¢ Send via gRPC/HTTP\n‚Ä¢ Transmit to collector" {
  style: {
    animated: true
    stroke-width: 5
    stroke: "#D32F2F"
    font-size: 16
    font-color: "#D32F2F"
    bold: true
  }
}

wire_world -> rel_world: "5Ô∏è‚É£ Collector Response\n‚Ä¢ Acknowledge receipt\n‚Ä¢ Batch confirmation\n‚Ä¢ Export status\n‚Ä¢ Error handling" {
  style: {
    animated: true
    stroke-width: 5
    stroke: "#D32F2F"
    stroke-dash: 5
    font-size: 16
    font-color: "#D32F2F"
    bold: true
  }
}

rel_world -> obj_world: "6Ô∏è‚É£ Data Retrieval\n‚Ä¢ Query results returned\n‚Ä¢ Load domain objects\n‚Ä¢ Fetch telemetry history\n‚Ä¢ Read from cache/DB" {
  style: {
    animated: true
    stroke-width: 5
    stroke: "#F57C00"
    stroke-dash: 5
    font-size: 16
    font-color: "#E65100"
    bold: true
  }
}

obj_world -> app_world: "7Ô∏è‚É£ Object Processing\n‚Ä¢ Process domain objects\n‚Ä¢ Update span attributes\n‚Ä¢ Add log entries\n‚Ä¢ Calculate metrics" {
  style: {
    animated: true
    stroke-width: 5
    stroke: "#388E3C"
    stroke-dash: 5
    font-size: 16
    font-color: "#388E3C"
    bold: true
  }
}

app_world -> http_world: "8Ô∏è‚É£ Response Generation\n‚Ä¢ Build HTTP response\n‚Ä¢ Add trace headers\n‚Ä¢ Set status code\n‚Ä¢ Send response to client\n‚Ä¢ End span" {
  style: {
    animated: true
    stroke-width: 5
    stroke: "#1976D2"
    stroke-dash: 5
    font-size: 16
    font-color: "#1976D2"
    bold: true
  }
}

